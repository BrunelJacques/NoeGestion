<mat-card [formGroup]="mainForm" class="main-form">
  <mat-card-title>Mon Compte</mat-card-title>
  <mat-card-subtitle>Votre situation Noegest?</mat-card-subtitle>
  <mat-radio-group [formControl]="situationCtrl">
    <mat-radio-button value="exist">Compte existant</mat-radio-button>
    <mat-radio-button value="new">Membre</mat-radio-button>
    <mat-radio-button value="info">Info</mat-radio-button>
  </mat-radio-group>
  <mat-card class="left" *ngIf=" 'info' === (situationCtrl$ | async)">
    <mat-card-subtitle class="mx-1 fond-titre">
      <mat-icon>search</mat-icon>Réservé aux collaborateurs Matthania, pas aux membres ou clients.
    </mat-card-subtitle>
    <mat-card-subtitle class="mx-3">
      <p class="m-0"><mat-icon>done</mat-icon> Si vous êtes titulaires d'un compte existant vous pourrez changer votre mot de passe ou vos coordonnées</p>
      <p class="m-0"><mat-icon>done</mat-icon> Sinon votre demande de création de compte sera analysée, vous serez informés en cas de validation</p>
    </mat-card-subtitle>
    
    <mat-card-actions class="right">
      <button mat-flat-button class="fond-soutenu  my-1 small10">
        <a routerLink="www.matthania.com">Voir Site Matthania<mat-icon>language</mat-icon></a>
      </button>
    </mat-card-actions>
  </mat-card>

  <div *ngIf=" 'info' !== (situationCtrl$ | async)">
    <mat-card class=" m-1" formGroupName="personalInfo" >
      <mat-card-subtitle>Informations personnelles</mat-card-subtitle>
      <div class="form-row m-1">
        <mat-form-field appearance="fill">
          <mat-label>Prénom</mat-label>
          <input type="text" matInput formControlName="firstName">
          <mat-error>Champ nécessaire </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Nom</mat-label>
          <input type="text" matInput formControlName="lastName">
          <mat-error>Champ nécessaire </mat-error>
        </mat-form-field>
      </div>
    </mat-card>

    <mat-card class="m-1" [formGroup]="emailForm" *ngIf="situationCtrl$ | async">
        <mat-card-subtitle>Vous joindre?</mat-card-subtitle>
        <div class="form-row m-1">
          <mat-form-field >
            <mat-label>Adresse mail</mat-label>
            <input type="text" matInput [formControl]="emailCtrl">
            <mat-error> {{getFormControlErrorText(emailCtrl)}} </mat-error>
          </mat-form-field>
          <mat-form-field >
            <mat-label>Téléphone</mat-label>
            <input type="text" matInput [formControl]="phoneCtrl">
            <mat-error> {{getFormControlErrorText(phoneCtrl)}} </mat-error>
          </mat-form-field>
        </div>
        <small class="error-text" *ngIf="showEmailError$ | async">Adresses différentes</small>
    </mat-card>

    <mat-card class="m-1" [formGroup]="loginInfoForm" >
      <div class="form-row">        
        <mat-card-subtitle >Informations de connexion</mat-card-subtitle>
        <mat-form-field >
          <mat-label>Identifiant</mat-label>
          <input type="text" matInput [formControl]="usernameCtrl">
          <mat-error>Champrequis</mat-error>
        </mat-form-field>
        <mat-form-field >
          <mat-label>Actuel MotDePasse</mat-label>
          <input type="password" matInput [formControl]="actuelpwCtrl">
          <mat-error> {{getFormControlErrorText(actuelpwCtrl)}} </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">        
        <mat-form-field >
          <mat-label>Mot de passe</mat-label>
          <input type="password" matInput [formControl]="passwordCtrl">
          <mat-error> {{getFormControlErrorText(passwordCtrl)}} </mat-error>
        </mat-form-field>
        <mat-form-field >
          <mat-label>Confirmation</mat-label>
          <input type="password" matInput [formControl]="confirmPasswordCtrl">
          <mat-error> {{getFormControlErrorText(confirmPasswordCtrl)}} </mat-error>
        </mat-form-field>
      </div>
      <small class="error-text" *ngIf="showPasswordError$ | async">Mots de passe différents</small>
    </mat-card>
  </div>
  <mat-card-actions>
    <button *ngIf=" 'info' !== (situationCtrl$ | async)"
    mat-flat-button color="primary" 
    type="submit"
    [disabled]="loading || !mainForm.valid"
    aria-label="Confirm">
      <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
      Demande<mat-icon>send</mat-icon>
    </button>
    <button mat-flat-button class="fond-soutenu m-3">
        <a routerLink="../login">Abandon<mat-icon>reply</mat-icon></a>
    </button>
  </mat-card-actions>

  <mat-spinner *ngIf="loading" color="primary" mode="indeterminate" > </mat-spinner>
</mat-card>

